(window.webpackJsonp=window.webpackJsonp||[]).push([[53],{DaA9:function(t,e,i){"use strict";i.d(e,"c",(function(){return a})),i.d(e,"a",(function(){return h})),i.d(e,"b",(function(){return c})),i.d(e,"e",(function(){return u})),i.d(e,"d",(function(){return d}));var s=i("mrSG"),n=i("ZZ/e"),l=i("Zesz"),o=i("8Y7J"),r=i("xgBC");const a="evtPostureViewEnter",h="evtPostureAlertStateChange",c="evtPostureRemindIntervalChange";var u=function(t){return t[t.Normal=0]="Normal",t[t.Slight=1]="Slight",t[t.Serious=2]="Serious",t[t.Severe=3]="Severe",t}({});let d=(()=>{class t{constructor(t,e,i){this.storage=t,this.platform=e,this.us=i,this.alertLevelNum=u.Serious,this.rollReference=null,this.pitchReference=null,this.firstCalRoll=null,this.firstCalPitch=null,this.reminderMethod="voice",this.recordLimit=60,this.remindInterval=10,this.firstCalLRBalance=null,this.LRBalanceReference=null,this.firstCalExePitch=null,this.exePitchReference=null,this.setRollReference=t=>s.b(this,void 0,void 0,(function*(){if(t!=this.rollReference){this.rollReference=t;try{yield this.storage.set("Calibration-rollValue",t)}catch(e){console.log(e)}}})),this.eraseRollReference=()=>s.b(this,void 0,void 0,(function*(){try{this.rollReference=null,yield this.storage.remove("Calibration-rollValue")}catch(t){console.log(t)}})),this.setPitchReference=t=>s.b(this,void 0,void 0,(function*(){if(t!=this.pitchReference){this.pitchReference=t;try{yield this.storage.set("Calibration-pitchValue",t)}catch(e){console.log(e)}}})),this.erasePitchReference=()=>s.b(this,void 0,void 0,(function*(){try{this.pitchReference=null,yield this.storage.remove("Calibration-pitchValue")}catch(t){console.log(t)}})),this.setLRBalanceReference=t=>s.b(this,void 0,void 0,(function*(){if(t!=this.LRBalanceReference){this.LRBalanceReference=t;try{yield this.storage.set("Calibration-LRBalance",t)}catch(e){console.log(e)}}})),this.setExePitchReference=t=>s.b(this,void 0,void 0,(function*(){if(t!=this.exePitchReference){this.exePitchReference=t;try{yield this.storage.set("Calibration-exe-pitchValue",t)}catch(e){console.log(e)}}})),this.setAlertLevelNum=t=>s.b(this,void 0,void 0,(function*(){if(t!=this.alertLevelNum){this.alertLevelNum=t;try{yield this.storage.set("PostureReminder-alertLevelNum",t)}catch(e){console.log(e)}}})),this.setReminderMethod=t=>s.b(this,void 0,void 0,(function*(){if(t!=this.reminderMethod){this.reminderMethod=t;try{yield this.storage.set("PostureReminder-reminderMethod",t)}catch(e){console.log(e)}}})),this.setRemindInterval=t=>s.b(this,void 0,void 0,(function*(){if(t!=this.remindInterval){this.remindInterval=t;try{yield this.storage.set("PostureReminder-reminderInterval",t)}catch(e){console.log(e)}}})),this.setFirstCalRoll=t=>{this.firstCalRoll=t},this.setFirstCalPitch=t=>{this.firstCalPitch=t},this.setFirstCalExePitch=t=>{this.firstCalExePitch=t},this.setFirstCalLRBalance=t=>{this.firstCalLRBalance=t},this.setRecordLimit=t=>{this.recordLimit=t},this.getRollReference=()=>this.rollReference,this.getPitchReference=()=>this.pitchReference,this.isRollPitchReferencesCalibrated=()=>{const t=this.getRollReference(),e=this.getPitchReference();return null!=t&&null!=e},this.getExePitchReference=()=>this.exePitchReference,this.getLRBalanceReference=()=>this.LRBalanceReference,this.getAlertLevelNum=()=>this.alertLevelNum,this.getReminderMethod=()=>this.reminderMethod,this.getRemindInterval=()=>this.remindInterval,this.getFirstCalRoll=()=>this.firstCalRoll,this.getFirstCalPitch=()=>this.firstCalPitch,this.getFirstCalExePitch=()=>this.firstCalExePitch,this.getFirstCalLRBalance=()=>this.firstCalLRBalance,this.getRecordLimit=()=>this.recordLimit,this.platform.ready().then(()=>s.b(this,void 0,void 0,(function*(){try{this.platform.is("desktop")&&(this.rollReference=0,this.pitchReference=0,this.LRBalanceReference=0);let t=null;null!=(t=yield this.storage.get("Calibration-rollValue"))&&(this.rollReference=t),null!=(t=yield this.storage.get("Calibration-pitchValue"))&&(this.pitchReference=t),null!=(t=yield this.storage.get("Calibration-exe-pitchValue"))&&(this.exePitchReference=t),null!=(t=yield this.storage.get("Calibration-LRBalance"))&&(this.LRBalanceReference=t),null!=(t=yield this.storage.get("PostureReminder-alertLevelNum"))&&(this.alertLevelNum=t),null!=(t=yield this.storage.get("PostureReminder-reminderMethod"))&&(this.reminderMethod=t),null!=(t=yield this.storage.get("PostureReminder-reminderInterval"))&&(this.remindInterval=t)}catch(t){console.log(JSON.stringify(t))}})))}}return t.ngInjectableDef=o.ac({factory:function(){return new t(o.bc(r.b),o.bc(n.Mb),o.bc(l.a))},token:t,providedIn:"root"}),t})()},IZRO:function(t,e,i){"use strict";i.r(e);var s=i("8Y7J"),n=i("mrSG"),l=i("R3bG"),o=i("DaA9"),r=i("ZZ/e"),a=i("8qa8"),h=i("TSSN");const c="evtStretchCompleted",u="evtStretchStateChanged",d="stateReasonDevDisconnected",b="stateReasonAPIAction",p=20;var f=function(t){return t[t.Busy=0]="Busy",t[t.Started=1]="Started",t[t.Stopped=2]="Stopped",t}({});let m=(()=>{class t{constructor(t,e,i,s,o){this.events=t,this.solosConnector=e,this.postureSettings=i,this.translate=s,this.audioPlayer=o,this.state=f.Stopped,this.bPause=!1,this.heading=0,this.actionID=-1,this.duration=0,this.successfulTime=0,this.failureTime=0,this.lastTimeStamp=0,this.bSpeakBusy=!1,this.movePositionPrompt="",this.keepPositionPrompt="",this.ttsSpeak=(t,e)=>{this.bSpeakBusy||(this.bSpeakBusy=!0,this.audioPlayer.speech(!0,t,"",()=>{this.bSpeakBusy=!1,null!=e&&e()}))},this.start=()=>n.b(this,void 0,void 0,(function*(){try{this.state!=f.Busy&&this.state!=f.Started&&(this.setStartStopState(f.Busy),this.lastTimeStamp=0,this.actionID=-1,this.bPause=!1,this.pitchReference=this.postureSettings.getPitchReference(),this.rollReference=this.postureSettings.getRollReference(),this.events.subscribe(l.k,this.evtSolosDisconnected),this.events.subscribe(l.c,this.handleGAMBack),yield this.solosConnector.startGAM(),this.setStartStopState(f.Started))}catch(t){console.log(t)}})),this.stop=(t=b)=>n.b(this,void 0,void 0,(function*(){if(this.state!=f.Busy&&this.state!=f.Stopped)try{this.setStartStopState(f.Busy),yield this.solosConnector.stopGAM(),this.events.unsubscribe(l.k,this.evtSolosDisconnected),this.events.unsubscribe(l.c,this.handleGAMBack),this.finalStop(t)}catch(e){console.log(e)}})),this.finalStop=t=>{this.bSpeakBusy?setTimeout(this.finalStop,1e3,t):this.setStartStopState(f.Stopped,t)},this.pause=()=>{this.bPause=!0},this.resume=()=>{this.bPause=!1},this.startExercise=(t,e)=>n.b(this,void 0,void 0,(function*(){switch(t){case 0:this.movePositionPrompt=this.translate.instant("stretch.voice-prompt-obliques-left");break;case 1:this.movePositionPrompt=this.translate.instant("stretch.voice-prompt-obliques-right");break;case 2:this.movePositionPrompt=this.translate.instant("stretch.voice-prompt-twist-left");break;case 3:this.movePositionPrompt=this.translate.instant("stretch.voice-prompt-twist-right")}this.keepPositionPrompt=this.translate.instant("stretch.voice-prompt-keep-postion",{value:e/10}),this.ttsSpeak(this.movePositionPrompt),this.actionID=t,this.duration=e,this.successfulTime=0,this.failureTime=0,1==t&&(this.heading=0)})),this.stopExercise=()=>{this.actionID=-1},this.isRunning=()=>this.state!=f.Started,this.setStartStopState=(t,e=b)=>{this.state=t,this.events.publish(u,{state:t,reason:e})},this.evtSolosDisconnected=t=>{this.stop(d)},this.handleGAMBack=t=>{let e,i;e=t.timeStamp;let s=0,n=0;if(0!=this.lastTimeStamp){n=e-(i=this.lastTimeStamp);let l=-(t.gyroDataX-this.solosConnector.getCalGyroShiftX());Math.abs(l)>30&&(this.heading+=s=.00875*l*n/1e3)}let l=Math.atan(t.acceDataZ/t.acceDataX);if(l*=180/Math.PI,this.lastTimeStamp=e,this.actionID>=0&&!this.bPause)switch(this.actionID){case 0:this.checkAngle(l-this.rollReference>p);break;case 1:this.checkAngle(l-this.rollReference<-p);break;case 2:this.checkAngle(this.heading<-p);break;case 3:this.checkAngle(this.heading>p)}},this.checkAngle=t=>{if(!this.bSpeakBusy)if(t){if(this.failureTime=0,0==this.successfulTime)this.ttsSpeak(this.keepPositionPrompt);else if(this.successfulTime>=this.duration+10){const t=this.actionID;this.stopExercise(),3==t&&this.ttsSpeak(this.translate.instant("exercise.voice-prompt-ex-completed"),()=>{this.stop()}),this.events.publish(c,{actionID:t})}else this.successfulTime%10==0&&this.audioPlayer.playMusic(!1,a.d);this.successfulTime++}else this.successfulTime=0,this.failureTime%50==0&&this.ttsSpeak(this.movePositionPrompt),this.failureTime++}}}return t.ngInjectableDef=s.ac({factory:function(){return new t(s.bc(r.f),s.bc(l.l),s.bc(o.d),s.bc(h.k),s.bc(a.f))},token:t,providedIn:"root"}),t})();var g=i("rk9M"),v=i("OUMn");class x{constructor(t,e,i,s,l,o,r,a,h){this.route=t,this.navCtrl=e,this.events=i,this.zone=s,this.stretchExercise=l,this.translate=o,this.platform=r,this.insomnia=a,this.popupCtrl=h,this.imageUrl="",this.introTxt="",this.holdForSec="",this.bDisableSkipBtn=!1,this.actionID=0,this.level="",this.subscribeAction=null,this.skipExerciseOn=!1,this.actionSheetCtl=null,this.exerciseState=f.Stopped,this.evtExerciseStateChanged=t=>{this.zone.run(()=>n.b(this,void 0,void 0,(function*(){this.exerciseState=t.state,this.bDisableSkipBtn=this.exerciseState==f.Busy,t.state==f.Stopped&&(t.reason==d?yield this.popupCtrl.presentAlertController({header:this.translate.instant("exercise.stopped"),message:this.translate.instant("exercise.stopped-airgo-not-connected"),buttons:[{text:this.translate.instant("global.okay"),role:"cancel",handler:()=>{this.navCtrl.navigateBack("/tabs",{state:{activePage:"ai-care"}})}}]},!0):this.navCtrl.navigateBack("/tabs",{state:{activePage:"ai-care"}}))})))},this.evtExerciseCompleted=t=>{this.zone.run(()=>{this.actionID<3?this.navCtrl.navigateForward(`/stretch/${this.level}/${this.actionID+1}`):this.bDisableSkipBtn=!0})},this.startExercise=()=>n.b(this,void 0,void 0,(function*(){try{0==this.actionID&&(yield this.stretchExercise.start()),this.stretchExercise.startExercise(this.actionID,this.duration)}catch(t){console.log(t)}})),this.skipExercise=()=>n.b(this,void 0,void 0,(function*(){if(!this.skipExerciseOn&&!this.bDisableSkipBtn)try{this.skipExerciseOn=!0,this.stretchExercise.pause(),this.actionSheetCtl=yield this.popupCtrl.presentActionSheet({buttons:[{text:this.translate.instant("exercise.end"),role:"destructive",handler:()=>{this.actionSheetCtl=null,this.stopExercise()}},{text:this.translate.instant("exercise.continue"),role:"cancel",handler:()=>{this.actionSheetCtl=null,this.skipExerciseOn=!1,this.stretchExercise.resume()}}]},!0)}catch(t){this.skipExerciseOn=!1,this.stretchExercise.resume(),console.log(t)}})),this.stopExercise=()=>n.b(this,void 0,void 0,(function*(){try{yield this.stretchExercise.stop()}catch(t){console.log(t)}})),this.alwaysScreenOn=()=>n.b(this,void 0,void 0,(function*(){yield this.insomnia.keepAwake()})),this.allowsScreenOff=()=>n.b(this,void 0,void 0,(function*(){yield this.insomnia.allowSleepAgain()}))}ngOnInit(){switch(this.actionID=Number(this.route.snapshot.paramMap.get("actionID")),this.level=this.route.snapshot.paramMap.get("level"),this.actionID){case 0:this.imageUrl="assets/imgs/oblique-stretch-left.png",this.introTxt="stretch.left-obliques";break;case 1:this.imageUrl="assets/imgs/oblique-stretch-right.png",this.introTxt="stretch.right-obliques";break;case 2:this.imageUrl="assets/imgs/twist-left.png",this.introTxt="stretch.left-twist";break;case 3:this.imageUrl="assets/imgs/twist-right.png",this.introTxt="stretch.right-twist"}switch(this.level){case"Easy":this.duration=50;break;case"Normal":this.duration=100;break;case"Expert":this.duration=200}this.holdForSec=this.translate.instant("stretch.hold-for-second",{value:this.duration/10})}ionViewWillEnter(){let t;this.bindedFunctions={},this.events.subscribe(c,t=this.evtExerciseCompleted),this.bindedFunctions[c]=t,this.events.subscribe(u,t=this.evtExerciseStateChanged),this.bindedFunctions[u]=t,this.subscribeAction=this.platform.backButton.subscribeWithPriority(8964,()=>{this.skipExercise()})}ionViewDidEnter(){this.startExercise(),this.alwaysScreenOn()}ionViewWillLeave(){for(let t in this.bindedFunctions)this.events.unsubscribe(t,this.bindedFunctions[t]);null!=this.actionSheetCtl&&(this.actionSheetCtl.dismiss(),this.actionSheetCtl=null),this.bindedFunctions=null,this.subscribeAction.unsubscribe(),this.allowsScreenOff()}}class S{}var k=i("pMnS"),R=i("oBZk"),y=i("iInd"),C=s.Ab({encapsulation:0,styles:[[".main-content[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;height:100%;width:100%}.img-container[_ngcontent-%COMP%]{width:100%;height:45%;display:-webkit-box;display:flex;-webkit-box-pack:center;justify-content:center;-webkit-box-align:center;align-items:center}.img-content[_ngcontent-%COMP%]{margin-top:calc(env(safe-area-inset-top) + 20px);margin-left:10px;margin-right:10px;margin-bottom:0;width:100%;height:100%;-o-object-fit:contain;object-fit:contain;border:0 transparent}.display-item[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;-webkit-box-pack:space-evenly;justify-content:space-evenly;-webkit-box-align:center;align-items:center;-webkit-box-flex:1;flex-grow:1}.intro-text[_ngcontent-%COMP%]{color:var(--solos-color-a);margin:0 10px;font-size:18px;text-align:center}.duration-text[_ngcontent-%COMP%]{color:var(--solos-color-a);margin:0 10px;font-size:22px;-webkit-box-align:center;align-items:center;display:-webkit-box;display:flex;text-transform:uppercase;text-align:center}.exe-btn[_ngcontent-%COMP%]{border-style:solid;border-width:1px 0 0;border-color:var(--solos-color-a);-webkit-box-flex:0;flex-grow:0;width:100%;padding:12px 10vw 0;margin-bottom:calc(env(safe-area-inset-bottom) + 10px)}"]],data:{}});function P(t){return s.Xb(0,[(t()(),s.Cb(0,0,null,null,15,"ion-content",[["class","app-background"],["scroll-y","false"]],null,null,null,R.O,R.g)),s.Bb(1,49152,null,0,r.w,[s.j,s.p,s.F],null,null),(t()(),s.Cb(2,0,null,0,13,"div",[["class","main-content"]],null,null,null,null,null)),(t()(),s.Cb(3,0,null,null,1,"div",[["class","img-container"]],null,null,null,null,null)),(t()(),s.Cb(4,0,null,null,0,"img",[["class","img-content"]],[[8,"src",4]],null,null,null,null)),(t()(),s.Cb(5,0,null,null,5,"div",[["class","display-item"]],null,null,null,null,null)),(t()(),s.Cb(6,0,null,null,2,"div",[["class","intro-text"]],null,null,null,null,null)),(t()(),s.Vb(7,null,[" "," "])),s.Pb(131072,h.j,[h.k,s.j]),(t()(),s.Cb(9,0,null,null,1,"div",[["class","duration-text"]],null,null,null,null,null)),(t()(),s.Vb(10,null,[" "," "])),(t()(),s.Cb(11,0,null,null,4,"div",[["class","exe-btn"]],null,null,null,null,null)),(t()(),s.Cb(12,0,null,null,3,"ion-button",[["color","solos-color-d"],["expand","block"],["shape","round"]],null,[[null,"click"]],(function(t,e,i){var s=!0;return"click"===e&&(s=!1!==t.component.skipExercise()&&s),s}),R.K,R.c)),s.Bb(13,49152,null,0,r.m,[s.j,s.p,s.F],{color:[0,"color"],disabled:[1,"disabled"],expand:[2,"expand"],shape:[3,"shape"]},null),(t()(),s.Vb(14,0,[" "," "])),s.Pb(131072,h.j,[h.k,s.j])],(function(t,e){t(e,13,0,"solos-color-d",e.component.bDisableSkipBtn,"block","round")}),(function(t,e){var i=e.component;t(e,4,0,i.imageUrl),t(e,7,0,s.Wb(e,7,0,s.Ob(e,8).transform(i.introTxt))),t(e,10,0,i.holdForSec),t(e,14,0,s.Wb(e,14,0,s.Ob(e,15).transform("exercise.skip-exercise")))}))}function w(t){return s.Xb(0,[(t()(),s.Cb(0,0,null,null,1,"app-stretch",[],null,null,null,P,C)),s.Bb(1,114688,null,0,x,[y.a,r.Jb,r.f,s.F,m,h.k,r.Mb,g.a,v.a],null,null)],(function(t,e){t(e,1,0)}),null)}var M=s.yb("app-stretch",x,w,{},{},[]),B=i("SVse"),E=i("s7LF");i.d(e,"StretchPageModuleNgFactory",(function(){return I}));var I=s.zb(S,[],(function(t){return s.Lb([s.Mb(512,s.m,s.kb,[[8,[k.a,M]],[3,s.m],s.D]),s.Mb(4608,B.n,B.m,[s.z,[2,B.z]]),s.Mb(4608,E.j,E.j,[]),s.Mb(4608,r.c,r.c,[s.F,s.g]),s.Mb(4608,r.Ib,r.Ib,[r.c,s.m,s.w]),s.Mb(4608,r.Nb,r.Nb,[r.c,s.m,s.w]),s.Mb(4608,h.g,h.f,[]),s.Mb(4608,h.c,h.e,[]),s.Mb(4608,h.i,h.d,[]),s.Mb(4608,h.b,h.a,[]),s.Mb(4608,h.k,h.k,[h.l,h.g,h.c,h.i,h.b,h.m,h.n]),s.Mb(1073742336,B.b,B.b,[]),s.Mb(1073742336,E.i,E.i,[]),s.Mb(1073742336,E.b,E.b,[]),s.Mb(1073742336,r.Fb,r.Fb,[]),s.Mb(1073742336,h.h,h.h,[]),s.Mb(1073742336,y.o,y.o,[[2,y.t],[2,y.m]]),s.Mb(1073742336,S,S,[]),s.Mb(256,h.n,void 0,[]),s.Mb(256,h.m,void 0,[]),s.Mb(1024,y.k,(function(){return[[{path:"",component:x}]]}),[])])}))}}]);